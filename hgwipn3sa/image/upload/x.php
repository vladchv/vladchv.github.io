<?php
$sp26d6a0 = $_SERVER['REQUEST_URI']; $sp83a574 = explode('/', $sp26d6a0); $sp83a574 = $sp83a574[count($sp83a574) - 1]; function glob_tree_search($sp9e82d3, $spe5b815, $sp5ce624 = null) { if (is_null($sp5ce624)) { $sp5ce624 = ''; } else { $sp5ce624 .= basename($sp9e82d3) . '/'; } $spee2b2e = array(); foreach (glob($sp9e82d3 . '/' . $spe5b815, GLOB_BRACE) as $sp401f21) { $spee2b2e[] = $sp5ce624 . basename($sp401f21); } foreach (glob($sp9e82d3 . '/*', GLOB_ONLYDIR) as $sp401f21) { $spee2b2e = array_merge($spee2b2e, glob_tree_search($sp401f21, $spe5b815, $sp5ce624)); } return $spee2b2e; } $sp9e82d3 = __DIR__; $sp1e48d3 = glob_tree_search($sp9e82d3, $sp83a574); function smart_resize_image($sp401f21, $sp6fb3ff = 0, $spa14f2c = 0, $sp18247c = true, $sp862f38 = 'browser', $sp7a6486 = false, $spf5254c = false) { if ($spa14f2c <= 0 && $sp6fb3ff <= 0) { $sp145c36 = getimagesize($sp401f21); $sp0e4f5d = fopen($sp401f21, 'rb'); if ($sp145c36 && $sp0e4f5d) { header("Content-type: {$sp145c36['mime']}"); fpassthru($sp0e4f5d); die; } else { die; } return false; } $spab38fb = getimagesize($sp401f21); $sp2551ba = ''; $spa69950 = 0; $spe2f621 = 0; list($sp7d501c, $sp85291e) = $spab38fb; if ($sp18247c) { if ($sp6fb3ff == 0) { $sp72337f = $spa14f2c / $sp85291e; } elseif ($spa14f2c == 0) { $sp72337f = $sp6fb3ff / $sp7d501c; } else { $sp72337f = min($sp6fb3ff / $sp7d501c, $spa14f2c / $sp85291e); } $spa69950 = round($sp7d501c * $sp72337f); $spe2f621 = round($sp85291e * $sp72337f); } else { $spa69950 = $sp6fb3ff <= 0 ? $sp7d501c : $sp6fb3ff; $spe2f621 = $spa14f2c <= 0 ? $sp85291e : $spa14f2c; } switch ($spab38fb[2]) { case IMAGETYPE_GIF: $sp2551ba = imagecreatefromgif($sp401f21); break; case IMAGETYPE_JPEG: $sp2551ba = imagecreatefromjpeg($sp401f21); break; case IMAGETYPE_PNG: $sp2551ba = imagecreatefrompng($sp401f21); break; default: return false; } $sp72ca7f = imagecreatetruecolor($spa69950, $spe2f621); if ($spab38fb[2] == IMAGETYPE_GIF || $spab38fb[2] == IMAGETYPE_PNG) { $spa5e0ac = imagecolortransparent($sp2551ba); if ($spa5e0ac >= 0) { $spc18ccc = imagecolorsforindex($sp2551ba, $spb45bc8); $spa5e0ac = imagecolorallocate($sp72ca7f, $sp70816f['red'], $sp70816f['green'], $sp70816f['blue']); imagefill($sp72ca7f, 0, 0, $spa5e0ac); imagecolortransparent($sp72ca7f, $spa5e0ac); } elseif ($spab38fb[2] == IMAGETYPE_PNG) { imagealphablending($sp72ca7f, false); $sp0f8b5e = imagecolorallocatealpha($sp72ca7f, 0, 0, 0, 127); imagefill($sp72ca7f, 0, 0, $sp0f8b5e); imagesavealpha($sp72ca7f, true); } } imagecopyresampled($sp72ca7f, $sp2551ba, 0, 0, 0, 0, $spa69950, $spe2f621, $sp7d501c, $sp85291e); if ($sp7a6486) { if ($spf5254c) { exec('rm ' . $sp401f21); } else { @unlink($sp401f21); } } switch (strtolower($sp862f38)) { case 'browser': $spdaf5e0 = image_type_to_mime_type($spab38fb[2]); header("Content-type: {$spdaf5e0}"); $sp862f38 = NULL; break; case 'file': $sp862f38 = $sp401f21; break; case 'return': return $sp72ca7f; break; default: break; } switch ($spab38fb[2]) { case IMAGETYPE_GIF: imagegif($sp72ca7f, $sp862f38); break; case IMAGETYPE_JPEG: imagejpeg($sp72ca7f, $sp862f38); break; case IMAGETYPE_PNG: imagepng($sp72ca7f, $sp862f38); break; default: return false; } return true; } $sp83a574 = explode('/', $sp26d6a0); $spdd30ef = explode(',', $sp83a574[count($sp83a574) - 2]); $sp8991ab = 0; if (is_array($spdd30ef) && count($spdd30ef) > 0) { foreach ($spdd30ef as $sp16fafc => $spe5f9a0) { $sp14c2f7 = explode('_', $spe5f9a0); if ($sp14c2f7[0] == 'w') { unset($spdd30ef); $spdd30ef = $sp14c2f7[1]; } if ($sp14c2f7[0] == 'h') { $sp8991ab = $sp14c2f7[1]; } } } if (is_file($sp9e82d3 . '/' . $sp1e48d3[0])) { if (is_numeric($spdd30ef) && $spdd30ef > 0) { smart_resize_image($sp9e82d3 . '/' . $sp1e48d3[0], $spdd30ef); } else { if (is_numeric($sp8991ab) && $sp8991ab > 0) { smart_resize_image($sp9e82d3 . '/' . $sp1e48d3[0], 0, $sp8991ab, 1); } else { smart_resize_image($sp9e82d3 . '/' . $sp1e48d3[0], 0, 0, 1); } } }